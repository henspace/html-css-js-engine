/* Copyright 2025 Steve Butler (henspace.com)
 * License: MIT
 */
let  fatalMessagePreamble = `Whoops! A serious error has occurred:`;let  fatalMessagePostamble = `Do you want to reload the page? If you cancel, we'll try to go back to the previous page.`;export function setFatalErrorText(preamble, postamble) {if (preamble) {fatalMessagePreamble = preamble;}if (postamble) {fatalMessagePostamble = postamble;}}export function showAndHandleFatalError(message, choiceMessage) {console.trace(message);const choice = confirm(`${fatalMessagePreamble}\n${message}\n\n${fatalMessagePostamble}`);if (choice) {location.reload();} else {history.back();}}export class Logger {#log;#maxSize;constructor(maxSize = 100) {this.#log = [];this.#maxSize = maxSize;}#append(message) {if (this.#log.length >= this.#maxSize) {this.#log.shift();}this.#log.push(message);}get markdown() {let result = '';for (const line of this.#log) {result += `+ ${line}\n`;}return result;}clear() {this.#log = [];}log(message) {this.#append(message);console.log(message);}debug(message) {this.#append(`debug: ${message}`);console.debug(message);}error(message) {this.#append(`error: ${message}`);console.error(message);}info(message) {this.#append(`info: ${message}`);console.info(message);}warn(message) {this.#append(`warn: ${message}`);console.warn(message);}}window.addEventListener('error', ((error) => {showAndHandleFatalError(`${error.message} ${error.filename}[${error.lineno}:${error.colno}]`);}));window.addEventListener('unhandledrejection', ((event) => {showAndHandleFatalError(`Unhandled promise rejection: ${event.reason}`);}));