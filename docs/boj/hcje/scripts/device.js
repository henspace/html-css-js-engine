/* Copyright 2025 Steve Butler (henspace.com)
 * License: MIT
 */
export function getDimensions(element) {let width;let height;if (element) {width = element.clientWidth || Number.parseInt(element.style.width);height = element.clientHeight || Number.parseInt(element.style.height);} else {width = window.innerWidth;height = window.innerHeight;}return {width, height};}export function getScaleToFitOrCover(width, height, cover, options) {const margin = options.margin ?? 0;const dimensions = getDimensions(options.element);const availableWidth = dimensions.width - 2 * margin;const availableHeight = dimensions.height - 2 * margin;let scale;if (cover) {scale = Math.max(availableWidth / width, availableHeight / height);} else {scale = Math.min(availableWidth / width, availableHeight / height);}console.debug(`${cover ? 'Cover' : 'Fit'} [${width}x${height}] into [${availableWidth}x${availableHeight} at scale ${scale.toFixed(2)}]`);return scale;}export function getScaleToFit(width, height, options) {return getScaleToFitOrCover(width, height, false, options ?? {});}export function getScaleToCover(width, height, options) {return getScaleToFitOrCover(width, height, true, options ?? {});}export class Keyboard {static #VIRTUAL_KEYDOWN_EVENT = 'virtualKeyDown';#listeners;constructor() {this.#listeners = new Map();addEventListener('keydown', (evt) => {const listener = this.#listeners.get(evt.key);if (listener && !(listener.noRepeat && evt.repeat)) {listener.callback()}});addEventListener(Keyboard.#VIRTUAL_KEYDOWN_EVENT, (evt) => {this.#listeners.get(evt.detail.key)?.callback();});}addDownListener(key, listener) {this.#listeners.set(key, listener);}removeDownListener(key) {this.#listeners.delete(key);}static simulateKeydown(key, dispatcher = window) {dispatcher.dispatchEvent(new CustomEvent(Keyboard.#VIRTUAL_KEYDOWN_EVENT, {detail: {key}}));}}export function enterFullscreen(element = document.documentElement, options) {if (!document.fullscreenElement) {element.requestFullscreen().then(() => console.debug(`Into fullscreen`)).catch((error) => {console.error(`Could not enter fullscreen mode: %{error.message}`);});}}export function exitFullscreen() {if (document.fullscreenElement) {document.exitFullscreen().then(() => console.debug('Exited fullscreen mode.')).catch((err) => console.error('Failed to exit fullscreen mode:', err));}}export function supportsTouch() {return window.hasOwnProperty('ontouchstart');}